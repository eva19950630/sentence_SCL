
{% load staticfiles %}
<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <title>A Sentence A Day</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- Icons Fonts -->
    <link rel="stylesheet" href="{% static 'icons-fonts/glyphicon-style.css' %}">
    <link href="https://file.myfontastic.com/aR4fpYP5juQuaFcCLbzkFZ/icons.css" rel="stylesheet">
    <!-- Fonts -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Favicon -->
    <!-- <link rel="shortcut icon" href="">-->
    <!-- Main styles CSS -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <!-- Navbar CSS -->
    <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
    <!-- Textfield CSS -->
    <link rel="stylesheet" href="{% static 'css/textfield.css' %}">
    <!-- Postcard CSS -->
    <link rel="stylesheet" href="{% static 'css/postcard.css' %}">
    <!-- Sentence CSS -->
    <link rel="stylesheet" href="{% static 'css/sentence.css' %}">
    <!-- Usermap CSS -->
    <link rel="stylesheet" href="{% static 'css/userMap.css' %}">
    <!-- WorldMAP CSS -->
    <link href="{% static 'css/jqvmap.css' %}" media="screen" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/sb-admin.css' %}">
    <!-- Morris Charts CSS -->
    <link rel="stylesheet" href="{% static 'css/morris.css' %}"> 
<!--    google+-->
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="17252888188-om3sbh9djgv8gk720e7gl5tcrjj2r6hn.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <!--    google+-->
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
  <script src="https://apis.google.com/js/api:client.js"></script>
    <script type="text/javascript" src="{% static 'js/GooglePlusLogin.js' %}"></script>
</head>

<body>
    
    <div id=”fb-root”></div>
        <!--facebook login block-->
        <script src="http://connect.facebook.net/en_US/all.js"></script>
    <script>
        // This is called with the results from from FB.getLoginStatus().
      // function statusChangeCallback(response) {
      //   console.log('statusChangeCallback');
      //   console.log(response);
      //   // The response object is returned with a status field that lets the
      //   // app know the current login status of the person.
      //   // Full docs on the response object can be found in the documentation
      //   // for FB.getLoginStatus().
      //   if (response.status === 'connected') {
      //     // Logged into your app and Facebook.
      //     testAPI();
      //   } else if (response.status === 'not_authorized') {
      //     // The person is logged into Facebook, but not your app.
      //     document.getElementById('status').innerHTML = 'Please log ' +
      //       'into this app.';
      //   } else {
      //     // The person is not logged into Facebook, so we're not sure if
      //     // they are logged into this app or not.
      //     document.getElementById('status').innerHTML = 'Please log ' +
      //       'into Facebook.';
      //   }
      // }

  // This function is called when someone finishes with the Login
  // Button.  See the onlogin handler attached to it in the sample
  // code below.
      // function checkLoginState() {
      //   FB.getLoginStatus(function(response) {
      //     statusChangeCallback(response);
      //   });
      // }  
        
        // var FaceBookAppId = '1868740400028340';//localhost:8000
        // window.fbAsyncInit = function () {
        //     FB.init({
        //         appId: FaceBookAppId,
        //         status: true,
        //         cookie: true
        //         , xfbml: true
        //         , version: 'v2.8'
        //     });
        //     window.fbloaded();
        //     FB.AppEvents.logPageView();
        // };
        
        
        // (function (d, s, id) {
        //     var js, fjs = d.getElementsByTagName(s)[0];
        //     if (d.getElementById(id)) {
        //         return;
        //     }
        //     js = d.createElement(s);
        //     js.id = id;
        //     js.src = "//connect.facebook.net/en_US/sdk.js";
        //     fjs.parentNode.insertBefore(js, fjs);
        // }(document, 'script', 'facebook-jssdk'));
        
        

        
        // function testAPI() {
        //     console.log('Welcome!  Fetching your information.... ');
        //     FB.api('/me', function(response) {
        //       console.log('Successful login for: ' + response.name);
        //       document.getElementById('status').innerHTML =
        //         'Thanks for logging in, ' + response.name + '!';
        //     });
        // }

    </script>
    
    

    
    
    <div class="header">
        <!-- Navigation -->
        <nav class="navbar-fixed-top" role="navigation">
            <!-- 1 POZIOM MENU -->
            <div class="navbar header-1">
                <div class="container">
                    <!-- Logo -->
                    <div id="header-logo" class="col-md-3 col-sm-6 col-xs-6">
                        <a href="/"> <img class="logo img-valign img-responsive" src="{% static 'images/logo.png' %}"> </a>
                    </div>
                    <!-- Social media + Menu MOBILE -->
                    <div class="col-md-9 col-sm-6 col-xs-6 header-mobile-sm">
                        <!-- Log in / Sign up -->
                        <div class="header-sm"> <span class="before-login">
                                <button type="button" class="btn btn-default navbar-btn" id="login-btn" data-toggle="modal">Log In</button>
                            </span> <span class="before-login">
                            <button type="button" class="btn btn-default navbar-btn" id="signup-btn" data-toggle="modal">Sign Up</button>
                            </span> <span class="after-login">

                                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                                    <i class="fa fa-bell" style="font-size: 25px; color:#000"></i>
                                  </a>
                                  <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                    <div><font color=white>&emsp;Notifications</font></div>
                                  </ul>
                                </span> <span class="after-login">
                                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                                    <i class="fa fa-user-circle" style="font-size: 25px; color:#000" id="user-pic"></i >
                                  <span id="user-name"><font color=#000>USER NAME<b class="caret"></b></font></span>
                                  <!-- <span id="user-backend-name"><font color=#000>{{username}}</font></span> -->
                                  </a>
                                  <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                    <li><a href="/user/usermap"><i class="fa fa-map" style="font-size: 20px;"></i>&emsp;User Map</a></li>
                                    <li><a href="/user/profile"><i class="fa fa-user-o" style="font-size: 20px;"></i>&emsp;Profile</a></li>
                                    <li class="divider"></li>
                                      <!--class="fb-log-out" written by gim for fb log out-->
                                    <li><button class="fa fa-sign-out fb-log-out">Logout</button>
                                    <a href="#"><i class="fa fa-sign-out fb-log-out" style="font-size: 20px;"></i>&emsp;Log out</a></li>
                                  </ul>
                                </span> </div>
                        <!-- Log in Modal -->
                        <div class="modal fade" id="login-modal" role="dialog">
                            <div class="modal-dialog">
                                <div id="login-box">

                                    <div class="top" style="padding: 15px;">
                                        <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
                                    </div>
                                    <div class="left">
                                        <h1>Welcome back!</h1>
                                        <form method = "POST" action = "/login_true/">
                                          
                                          {% csrf_token %}
                                          {{ form.as_p }}
                                          
                                            <input type="text" name="email" placeholder="E-mail" />
                                            <input type="password" name="password" placeholder="Password" />
                                            <!-- <a href="/"> -->
                                            <input type="submit" class="loginButton" name="login_submit" value="Log in" /> 
                                            <!-- </a>                                          -->
                                        </form>                                       
                                    </div>
                                    <div class="login-right"> 
                                        <button class="social-signin facebook facebook-login-btn">Log in with facebook</button>
                                        <button class="social-signin google" id="customBtn-login">Log in with Google</button>
<!--                                        <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>-->
                                    </div>
                                    <div class="login-or">OR</div>
                                    <div class="mobile-login-right"> <span><a href="" class="sm sm-anim1 sm-facebook icon-ao-facebook" target="_blank"></a></span> <span><a href="" class="sm sm-anim1 sm-googleplus icon-ao-google" target="_blank"></a></span> </div>
                                </div>
                            </div>
                        </div>
                        <!-- Sign up Modal -->
                        <div class="modal fade" id="signup-modal" role="dialog">
                            <div class="modal-dialog">
                                <div id="signup-box">
                                    <div class="top" style="padding: 15px;">
                                        <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
                                    </div>
                                    <div class="left">
                                        <h1>Create an account</h1>
                                        
                                        <form method = "POST" action = "/login/">
                                          
                                          {% csrf_token %}
                                          {{ form.as_p }}
                                          
                                          <input type="text" name="name" placeholder="Username" />
                                          <input type="text" name="email" placeholder="E-mail" />
                                          <input type="password" name="password" placeholder="Password" />
                                          <input type="password" name="password" placeholder="Retype password" />
                                          <!--<a href="/login"></a>-->
                                          <input type="submit" class="signupBtn" name="signup_submit" value="Sign me up" />
                                        </form>
                                        
                                    </div>      
                                    
                                    <div class="signup-right">
                                        <button class="social-signin facebook facebook-login-btn">Log in with facebook</button>
                                        <button class="social-signin google" id="customBtn-signup">Log in with Google</button>
                                    </div>
                                     
   
                                    <div class="signup-or">OR</div>
                                    <div class="mobile-signup-right"> <span><a href="" class="sm sm-anim1 sm-facebook icon-ao-facebook" target="_blank"></a></span> <span><a href="" class="sm sm-anim1 sm-googleplus icon-ao-google" target="_blank"></a></span> </div>

                                </div>
                            </div>
                        </div>
                        <!-- Menu MOBILE -->
                        <div class=".header-mobile navbar-header">
                            <button type="button" class="navbar-toggle icon-ao-bar-4 ao-menu-bar" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 2 POZIOM MENU -->
            <div class="navbar header-2">
                <div class="container">
                    <!-- Menu -->
                    <div class="collapse navbar-collapse scroll navbar-bg" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav navbar-right">
                            <li class="ao_menu_list active"> <a href="/">DAILY TOPIC</a> </li>
                            <li class="ao_menu_list"> <a href="/">DAILY SENTENCE</a> </li>
                            <!--<li class="dropdown ao_menu_list">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OFERTA <b class="caret"></b></a>
                                        <ul class="dropdown-menu">
                                            <li>
                                                <a href="#">STRONY WWW</a>
                                            </li>
                                            <li>
                                                <a href="#">ANYONE WORDPRESS THEME</a>
                                            </li>
                                            <li>
                                                <a href="#">PLUGINS</a>
                                            </li>
                                        </ul>
                                    </li>-->
                            <div class="ao_menu_search">
                                <input type="search-mobile"> <i class="icon-ao-loupe-2 search-icon-loupe"></i>
                                <button class="icon-ao-close-2 search-icon-close ao_menu_close"></button>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </div>
    
   
    <div class="body"> {% block content1 %} {% endblock content1 %} </div>
    <div class="body-2"> {% block content2 %} {% endblock content2 %} </div>
    <div class="footer"> </div>
    <!-- ##### JAVASCRIPTS ##### -->
    <!-- jQuery Library -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- jQuery ui custom Library -->
    <script type="text/javascript" src="{% static 'jquery-ui-1.12.1.custom/jquery-ui.min.js' %}"></script>
    <!-- Bootstrap js -->
    <script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- Navbar js -->
    <script type="text/javascript" src="{% static 'js/navbar.js' %}"></script>
    <!-- Textfield js -->
    <script type="text/javascript" src="{% static 'js/textfield.js' %}"></script>
    <!-- Sentence js -->
    <script type="text/javascript" src="{% static 'js/sentence.js' %}"></script>
    <!-- Usermap js -->
    <script type="text/javascript" src="{% static 'js/UserMap.js' %}"></script>
    <!-- Painting js -->
    <script type="text/javascript" src="{% static 'js/Painting.js' %}"></script>
    <!-- WorldMAP js -->
    <script type="text/javascript" src="{% static 'js/jquery.vmap.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/maps/jquery.vmap.world.js' %}"></script>
    <script type="text/javascript">
        jQuery(document).ready(function () {
            jQuery('#vmap').vectorMap({
                map: 'world_en'
            });
        });
    </script>
    <!-- Morris Charts JavaScript -->
    <script type="text/javascript" src="{% static 'js/plugins/morris/raphael.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/plugins/morris/morris.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/plugins/morris/morris-data.js' %}"></script>
    <!-- Imagefile js -->
    <script>
        var icon1 = "{% static 'images/whale.png' %}";
        var icons = new Array();
        icons[0] = new Image();
        icons[0].src = "{% static 'images/whale.png' %}";
        icons[1] = new Image();
        icons[1].src = "{% static 'images/fish.png' %}"
    </script>  

</body>
<!--    facebookApi-->
     <script type="text/javascript">


     var FaceBookAppId = '1868740400028340';//localhost:8000
        window.fbAsyncInit = function () {
            FB.init({
                appId: FaceBookAppId,
                status: true,
                cookie: false
                , xfbml: true
                , version: 'v2.8'
            });
            window.fbloaded();
            FB.AppEvents.logPageView();
        };
        
        
        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {
                return;
            }
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
     
    window.fbloaded = function(){
        
        var userpicture;
        var useremail;

        //fb status connected not_authorized unknown
        FB.Event.subscribe('auth.statusChange', function(response){
            // console.log(response.status);
            if(response.status === 'connected'){
                FB.api("/me/picture?widrh=30" , function(response){
                    userpicture = response.data.url;
                    $("#user-pic").replaceWith('<img src="' + response.data.url + '" height="40" width="40" id="user-pic">');
                        
                });
        
                var userId;
                FB.api("/me",function(response){
                    var username = response.name;
                    $('#user-name').html(response.name);
                    $.get('/getuserid/',{
                        username: response.name,
                        userId: response.id,
                        useremail: useremail
                     },function(data){

                     });
                    console.log(username );
                });

                // FB.api('/me', {fields: 'email' },function(response) {
                //     console.log(response.email);
                //     useremail = response.email;
                //   }
                // );
                // loginState = true;
                

                 // FB.getLoginStatus(function(response) {
                 //      if (response.status == 'connected') {
                 //        getCurrentUserInfo(response)
                 //      } else {
                 //        FB.login(function(response) {
                 //          if (response.authResponse){
                 //            getCurrentUserInfo(response)
                 //          } else {
                 //            console.log('Auth cancelled.')
                 //          }
                 //        }, { scope: 'email' });
                 //      }
                 //    });

                 //    function getCurrentUserInfo() {
                 //      FB.api('/me', function(userInfo) {
                 //        console.log(userInfo.name + ': ' + userInfo.email);
                 //      });
                 //    }


            }
        });
        // FB.getLoginStatus(handleSessionResponse);
    } 

//     function handleSessionResponse(response) {
//     //if we dont have a session (which means the user has been logged out, redirect the user)
//     if (!response.session) {
//         // window.location = "/mysite/Login.aspx";
//         console.log("not session");
//         $("#user-pic").replaceWith('<i class="fa fa-user-circle" style="font-size: 25px; color:#000" id="user-pic"></i >');
//         $('#user-name').html('USER NAME');
//         return;
//     }

//     //if we do have a non-null response.session, call FB.logout(),
//     //the JS method will log the user out of Facebook and remove any authorization cookies
//     FB.logout(handleSessionResponse);
// }

    var loginCheck = function(){
        FB.getLoginStatus(function(response){
            console.log('button '+response.status);
            if(response.status === 'connected'){
               // console.log("connected");
                FB.logout(function(response){
                    $.get('/logout/');
                    $("#user-pic").replaceWith('<i class="fa fa-user-circle" style="font-size: 25px; color:#000" id="user-pic"></i >');
                    $('#user-name').html('USER NAME');
                    console.log("logout");
                    // $('.facebook-login-btn').html("Facebook Login");
                    // $('#user-pic').attr("src", "");
                    // $('#user-name').html(null);
                    /*facebook friend list
                    $(".friend-block").empty();
                    */
                });
            }else{
                console.log("login");
                FB.login(function(response){
                    $('.facebook-login-btn').html("facebook Logout");
                });
            }
        });
    }
     

     $(".facebook-login-btn").click(function(){
         loginCheck();
     });

     $(".fb-log-out").click(function(){
        loginCheck();
     });     
     //console.log(loginState);
         //startApp();
    </script>


<!-- sign up js -->
    {% for user in users %}
    
    <script type="text/javascript">
        $('.signupBtn').click(function() {
    		$('#user-name').html({{ username }});
    	});
        $('.loginButton').click(function() {
            $('#user-name').html({{ username }});
        });
    </script>
    
    {%  endfor %}
    
</html>